# This file was generated by https://github.com/kamilchm/go2nix v1.3.0
{ stdenv, buildGoPackage, fetchFromGitHub }:

buildGoPackage rec {
  name = "direnv-caascad-${version}";
  version = "2.21.2-cc.3";

  goPackagePath = "github.com/Caascad/direnv";

  src = fetchFromGitHub {
    owner = "Caascad";
    repo = "direnv";
    rev = "33c4615bd4aa2ad269bf19f1d33f1d8212dfd4cb";
    sha256 = "1bjgf8ywh5dhhfr9lkj084fxzarghb2b8msf8di1agmz26wlbv2l";
  };

  goDeps = ./deps.nix;

  installPhase = ''
    runHook preInstall

    mkdir -p $bin
    dir="$NIX_BUILD_TOP/go/bin"
    [ -e "$dir" ] && cp -r $dir $bin

    cp $NIX_BUILD_TOP/go/src/$goPackagePath/script/source_hash $bin/bin/source_hash

    runHook postInstall
  '';

  meta = with stdenv.lib; {
      description = "A shell extension that manages your environment";
      longDescription = ''
        Once hooked into your shell direnv is looking for an .envrc file in your
        current directory before every prompt.

        If found it will load the exported environment variables from that bash
        script into your current environment, and unload them if the .envrc is
        not reachable from the current path anymore.

        In short, this little tool allows you to have project-specific
        environment variables.
      '';
      homepage = https://direnv.net;
      license = licenses.mit;
  };
}
